import { c as createComponent, i as renderComponent, r as renderTemplate, f as createAstro, j as defineScriptVars, e as addAttribute, m as maybeRenderHead } from '../../chunks/astro/server_BHTwyJnf.mjs';
import 'piccolore';
import { $ as $$MainLayout } from '../../chunks/MainLayout_jYN9VHFs.mjs';
import { f as fetchWithCache } from '../../chunks/movieCache_B2tc5jSX.mjs';
export { renderers } from '../../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro();
const $$ = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$;
  const { slug } = Astro2.params;
  let movie = null;
  let episodes = [];
  try {
    const targetUrl = `https://zeldvorik.ru/apiv3/api.php?action=detail&detailPath=${slug}`;
    const data = await fetchWithCache(targetUrl, 60 * 60 * 1e3);
    if (data && data.success) {
      movie = data.data;
      if (movie.seasons) {
        episodes = movie.seasons;
      } else {
        const raw = movie.episodes || movie.list_episode || movie.episode || [];
        episodes = Array.isArray(raw) ? raw : Object.values(raw);
      }
    } else {
      return Astro2.redirect("/404");
    }
  } catch (e) {
    console.error("Error Detail Page:", e instanceof Error ? e.message : String(e));
    return Astro2.redirect("/404");
  }
  if (!movie) {
    return Astro2.redirect("/404");
  }
  function truncateWords(text, limit = 155) {
    if (!text) return "";
    return text.split(" ").slice(0, 25).join(" ") + "...";
  }
  return renderTemplate`${renderComponent($$result, "MainLayout", $$MainLayout, { "title": `Nonton ${movie.title} Subtitle Indonesia | Nobarin`, "description": `Streaming ${movie.title} (${movie.year}) subtitle Indonesia. ${truncateWords(movie.description)}`, "schema": {
    "@context": "https://schema.org",
    "@type": "Movie",
    name: movie.title,
    image: movie.poster,
    datePublished: movie.year,
    description: movie.description,
    aggregateRating: movie.rating && {
      "@type": "AggregateRating",
      ratingValue: movie.rating,
      ratingCount: "1000"
    }
  } }, { "default": async ($$result2) => renderTemplate(_a || (_a = __template([" ", '<div class="container mx-auto px-4 py-24 min-h-screen"> <a href="/" class="inline-flex items-center text-gray-400 hover:text-white mb-6 transition-colors"> <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>\nKembali ke Beranda\n</a> <div class="flex flex-col lg:flex-row gap-8"> <div class="w-full lg:w-2/3 order-1 lg:order-2"> <div id="playerContainer" class="aspect-video w-full bg-black rounded-xl overflow-hidden shadow-2xl ring-1 ring-purple-500/30 relative"> <iframe id="videoPlayer"', ' class="w-full h-full" allowfullscreen frameborder="0" allow="autoplay; encrypted-media"></iframe> </div> <div class="mt-6 border-b border-white/10 pb-6"> <h1 class="text-2xl md:text-4xl font-bold text-white mb-3 leading-tight">Nonton ', ' Subtitle Indonesia</h1> <div class="flex flex-wrap gap-3 text-sm"> <span class="bg-purple-600 text-white px-2 py-0.5 rounded text-xs font-bold flex items-center">', ' \u2B50</span> <span class="bg-white/10 text-gray-300 px-2 py-0.5 rounded text-xs font-bold">', '</span> <span class="bg-white/10 text-purple-300 px-2 py-0.5 rounded text-xs font-bold capitalize">', '</span> <span class="text-gray-500">\u2022</span> <span class="text-gray-400">', '</span> <p class="text-gray-400 text-sm leading-relaxed max-w-3xl">\nStreaming film ', " subtitle Indonesia tahun ", '. Tonton online kualitas HD hanya di Nobarin.\n</p> </div> </div> <div class="mt-8"> <div class="flex items-center justify-between mb-4"> <h3 class="text-lg font-bold text-white uppercase tracking-widest border-l-4 border-purple-500 pl-3">Daftar Episode</h3> <span class="text-xs text-gray-500 italic">Klik untuk memutar</span> </div> <div class="max-h-[400px] overflow-y-auto pr-2 custom-scrollbar p-1"> ', ' </div> </div> <div class="mt-12 glass p-6 rounded-2xl"> <h3 class="text-lg font-bold text-white mb-4 uppercase tracking-widest border-b border-white/10 pb-2">Komentar</h3> <div id="disqus_thread" class="min-h-[200px]"></div> </div> </div> <div class="w-full lg:w-1/3 order-2 lg:order-1"> <div class="sticky top-24"> <div class="relative group rounded-xl overflow-hidden shadow-2xl mb-6 border border-white/10"> <img', ' class="w-full h-auto object-cover transform group-hover:scale-105 transition duration-700"', ' loading="lazy"> <div class="absolute inset-0 bg-gradient-to-t from-dark/80 to-transparent pointer-events-none"></div> </div> <div class="glass p-5 rounded-xl border border-white/5"> <h4 class="text-purple-400 font-bold mb-3 uppercase text-xs tracking-wider flex items-center"> <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>\nSinopsis\n</h4> <p class="text-gray-400 text-sm leading-relaxed text-justify">', "</p> </div> </div> </div> </div> </div> <script>(function(){", '\n    const STORAGE_KEY = "nobar_history";\n\n    function saveHistory(episodeNumber) {\n      try {\n        let history = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");\n        history[slug] = {\n          title: movie.title,\n          poster: movie.poster,\n          detailPath: slug,\n          lastEpisode: parseInt(episodeNumber),\n          type: movie.type,\n          timestamp: Date.now(),\n        };\n\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(history));\n        console.log("History updated:", history[slug]);\n      } catch (e) {\n        console.error("Gagal simpan history:", e);\n      }\n    }\n\n    const container = document.getElementById("playerContainer");\n    const buttons = document.querySelectorAll(".ep-btn");\n    const currentHistory = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");\n    const existingData = currentHistory[slug];\n\n    if (existingData) {\n      saveHistory(existingData.lastEpisode);\n    } else {\n      saveHistory(1);\n    }\n\n    buttons.forEach((btn) => {\n      btn.addEventListener("click", () => {\n        const url = btn.getAttribute("data-url");\n        const epNum = btn.getAttribute("data-ep");\n\n        saveHistory(epNum);\n\n        Swal.fire({\n          toast: true,\n          position: "top-end",\n          icon: "info",\n          title: `Memutar Episode ${epNum}...`,\n          showConfirmButton: false,\n          timer: 1500,\n          background: "#1e1b4b",\n          color: "#fff",\n        });\n\n        if (url.includes(".mp4") || url.includes("video-proxy.php")) {\n          container.innerHTML = `\n                  <video id="videoPlayer" controls autoplay class="w-full h-full rounded-xl bg-black">\n                      <source src="${url}" type="video/mp4">\n                  </video>`;\n        } else {\n          container.innerHTML = `\n                  <iframe id="videoPlayer" src="${url}" class="w-full h-full rounded-xl"\n                      allowfullscreen frameborder="0" allow="autoplay; encrypted-media">\n                  </iframe>`;\n        }\n        container.scrollIntoView({ behavior: "smooth", block: "center" });\n      });\n    });\n\n    var disqus_config = function () {\n      this.page.url = window.location.href;\n      this.page.identifier = slug;\n    };\n    (function () {\n      if (document.getElementById("disqus-script")) return;\n      var d = document,\n        s = d.createElement("script");\n      s.src = "https://nobarin-1.disqus.com/embed.js";\n      s.id = "disqus-script";\n      s.setAttribute("data-timestamp", +new Date());\n      (d.head || d.body).appendChild(s);\n    })();\n  })();<\/script> '], [" ", '<div class="container mx-auto px-4 py-24 min-h-screen"> <a href="/" class="inline-flex items-center text-gray-400 hover:text-white mb-6 transition-colors"> <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>\nKembali ke Beranda\n</a> <div class="flex flex-col lg:flex-row gap-8"> <div class="w-full lg:w-2/3 order-1 lg:order-2"> <div id="playerContainer" class="aspect-video w-full bg-black rounded-xl overflow-hidden shadow-2xl ring-1 ring-purple-500/30 relative"> <iframe id="videoPlayer"', ' class="w-full h-full" allowfullscreen frameborder="0" allow="autoplay; encrypted-media"></iframe> </div> <div class="mt-6 border-b border-white/10 pb-6"> <h1 class="text-2xl md:text-4xl font-bold text-white mb-3 leading-tight">Nonton ', ' Subtitle Indonesia</h1> <div class="flex flex-wrap gap-3 text-sm"> <span class="bg-purple-600 text-white px-2 py-0.5 rounded text-xs font-bold flex items-center">', ' \u2B50</span> <span class="bg-white/10 text-gray-300 px-2 py-0.5 rounded text-xs font-bold">', '</span> <span class="bg-white/10 text-purple-300 px-2 py-0.5 rounded text-xs font-bold capitalize">', '</span> <span class="text-gray-500">\u2022</span> <span class="text-gray-400">', '</span> <p class="text-gray-400 text-sm leading-relaxed max-w-3xl">\nStreaming film ', " subtitle Indonesia tahun ", '. Tonton online kualitas HD hanya di Nobarin.\n</p> </div> </div> <div class="mt-8"> <div class="flex items-center justify-between mb-4"> <h3 class="text-lg font-bold text-white uppercase tracking-widest border-l-4 border-purple-500 pl-3">Daftar Episode</h3> <span class="text-xs text-gray-500 italic">Klik untuk memutar</span> </div> <div class="max-h-[400px] overflow-y-auto pr-2 custom-scrollbar p-1"> ', ' </div> </div> <div class="mt-12 glass p-6 rounded-2xl"> <h3 class="text-lg font-bold text-white mb-4 uppercase tracking-widest border-b border-white/10 pb-2">Komentar</h3> <div id="disqus_thread" class="min-h-[200px]"></div> </div> </div> <div class="w-full lg:w-1/3 order-2 lg:order-1"> <div class="sticky top-24"> <div class="relative group rounded-xl overflow-hidden shadow-2xl mb-6 border border-white/10"> <img', ' class="w-full h-auto object-cover transform group-hover:scale-105 transition duration-700"', ' loading="lazy"> <div class="absolute inset-0 bg-gradient-to-t from-dark/80 to-transparent pointer-events-none"></div> </div> <div class="glass p-5 rounded-xl border border-white/5"> <h4 class="text-purple-400 font-bold mb-3 uppercase text-xs tracking-wider flex items-center"> <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>\nSinopsis\n</h4> <p class="text-gray-400 text-sm leading-relaxed text-justify">', "</p> </div> </div> </div> </div> </div> <script>(function(){", '\n    const STORAGE_KEY = "nobar_history";\n\n    function saveHistory(episodeNumber) {\n      try {\n        let history = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");\n        history[slug] = {\n          title: movie.title,\n          poster: movie.poster,\n          detailPath: slug,\n          lastEpisode: parseInt(episodeNumber),\n          type: movie.type,\n          timestamp: Date.now(),\n        };\n\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(history));\n        console.log("History updated:", history[slug]);\n      } catch (e) {\n        console.error("Gagal simpan history:", e);\n      }\n    }\n\n    const container = document.getElementById("playerContainer");\n    const buttons = document.querySelectorAll(".ep-btn");\n    const currentHistory = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");\n    const existingData = currentHistory[slug];\n\n    if (existingData) {\n      saveHistory(existingData.lastEpisode);\n    } else {\n      saveHistory(1);\n    }\n\n    buttons.forEach((btn) => {\n      btn.addEventListener("click", () => {\n        const url = btn.getAttribute("data-url");\n        const epNum = btn.getAttribute("data-ep");\n\n        saveHistory(epNum);\n\n        Swal.fire({\n          toast: true,\n          position: "top-end",\n          icon: "info",\n          title: \\`Memutar Episode \\${epNum}...\\`,\n          showConfirmButton: false,\n          timer: 1500,\n          background: "#1e1b4b",\n          color: "#fff",\n        });\n\n        if (url.includes(".mp4") || url.includes("video-proxy.php")) {\n          container.innerHTML = \\`\n                  <video id="videoPlayer" controls autoplay class="w-full h-full rounded-xl bg-black">\n                      <source src="\\${url}" type="video/mp4">\n                  </video>\\`;\n        } else {\n          container.innerHTML = \\`\n                  <iframe id="videoPlayer" src="\\${url}" class="w-full h-full rounded-xl"\n                      allowfullscreen frameborder="0" allow="autoplay; encrypted-media">\n                  </iframe>\\`;\n        }\n        container.scrollIntoView({ behavior: "smooth", block: "center" });\n      });\n    });\n\n    var disqus_config = function () {\n      this.page.url = window.location.href;\n      this.page.identifier = slug;\n    };\n    (function () {\n      if (document.getElementById("disqus-script")) return;\n      var d = document,\n        s = d.createElement("script");\n      s.src = "https://nobarin-1.disqus.com/embed.js";\n      s.id = "disqus-script";\n      s.setAttribute("data-timestamp", +new Date());\n      (d.head || d.body).appendChild(s);\n    })();\n  })();<\/script> '])), maybeRenderHead(), addAttribute(movie.playerUrl, "src"), movie.title, movie.rating || "N/A", movie.year, movie.type, movie.genre, movie.title, movie.year, movie.seasons ? movie.seasons.map((season) => renderTemplate`<div class="mb-4"> <div class="sticky top-0 bg-dark/95 backdrop-blur z-10 py-2 mb-2 border-b border-white/5"> <p class="text-purple-400 font-bold text-xs uppercase tracking-wider">Season ${season.season}</p> </div> <div class="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-2"> ${season.episodes.map((ep, idx) => renderTemplate`<button class="ep-btn group relative py-2 bg-white/5 hover:bg-purple-600 active:bg-purple-700 rounded text-[11px] font-bold transition-all border border-white/5 text-center truncate px-1"${addAttribute(ep.url || ep.playerUrl, "data-url")}${addAttribute(ep.episode || idx + 1, "data-ep")}> <span class="group-hover:text-white text-gray-300">Ep ${ep.episode || idx + 1}</span> </button>`)} </div> </div>`) : renderTemplate`<div class="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-2"> ${episodes.map((ep, idx) => renderTemplate`<button class="ep-btn group py-2 bg-white/5 hover:bg-purple-600 active:bg-purple-700 rounded text-[11px] font-bold transition-all border border-white/5 text-center truncate px-1"${addAttribute(ep.url || ep.playerUrl, "data-url")}${addAttribute(ep.episode || idx + 1, "data-ep")}> <span class="group-hover:text-white text-gray-300">Ep ${ep.episode || idx + 1}</span> </button>`)} </div>`, addAttribute(movie.poster, "src"), addAttribute(`Nonton ${movie.title} Subtitle Indonesia Poster`, "alt"), movie.description || "Tidak ada sinopsis tersedia untuk film ini.", defineScriptVars({ movie, slug })) })}`;
}, "D:/FILE_IRFAN/Coding/nobar-astro/src/pages/nonton/[...slug].astro", void 0);

const $$file = "D:/FILE_IRFAN/Coding/nobar-astro/src/pages/nonton/[...slug].astro";
const $$url = "/nonton/[...slug]";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
